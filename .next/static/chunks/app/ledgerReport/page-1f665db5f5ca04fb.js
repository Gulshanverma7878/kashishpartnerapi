(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[220],{413:(e,t,r)=>{"use strict";r.d(t,{M:()=>l});var a=r(1990),s=r(2525);let l=(0,a.U1)({reducer:{auth:s.Ay}})},1427:(e,t,r)=>{Promise.resolve().then(r.bind(r,7997))},2525:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,LA:()=>s,Qv:()=>n,ri:()=>l});let a=(0,r(1990).Z0)({name:"auth",initialState:{token:null,user:null,isAuthenticated:!1},reducers:{setCredentials:(e,t)=>{let{token:r,user:a}=t.payload;e.token=r,r&&!(r.length<=0)&&(e.user=a,e.isAuthenticated=!0,localStorage.setItem("token",r),localStorage.setItem("user",JSON.stringify(a)))},updateToken:(e,t)=>{let r=t.payload;r&&!(r.length<=0)&&(e.token=r,e.isAuthenticated=!0,localStorage.setItem("token",r))},updateUser:(e,t)=>{let r=t.payload;e.user=r,localStorage.setItem("user",JSON.stringify(r))},logout:e=>{e.token=null,e.user=null,e.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("user")},hydrate:e=>{let t=localStorage.getItem("token"),r=localStorage.getItem("user");e.token=t,e.user=r&&JSON.parse(r),e.isAuthenticated=!!(t&&r)}}}),{setCredentials:s,logout:l,hydrate:n,updateToken:o,updateUser:i}=a.actions,c=a.reducer},4436:(e,t,r)=>{"use strict";r.d(t,{k5:()=>d});var a=r(2115),s={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},l=a.createContext&&a.createContext(s),n=["attr","size","title"];function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var a,s,l;a=e,s=t,l=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in a?Object.defineProperty(a,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[s]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>a.createElement(u,o({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>a.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var r,{attr:s,size:l,title:i}=e,d=function(e,t){if(null==e)return{};var r,a,s=function(e,t){if(null==e)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(e,n),u=l||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),a.createElement("svg",o({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,d,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),i&&a.createElement("title",null,i),e.children)};return void 0!==l?a.createElement(l.Consumer,null,e=>t(e)):t(s)}},5784:(e,t,r)=>{"use strict";r.d(t,{S:()=>i});var a=r(3464),s=r(413),l=r(2525),n=r(6671);let o=r(9509).env.NEXT_PUBLIC_API_URL||"https://api.partner.kashishindiapvtltd.com/",i=a.A.create({baseURL:o,headers:{"Content-Type":"application/json"},timeout:6e5});i.interceptors.request.use(e=>{let t=s.M.getState().auth.token;return e.data instanceof FormData?e.headers["Content-Type"]="multipart/form-data":e.headers["Content-Type"]="application/json",t&&(e.headers.Authorization="Bearer ".concat(t)),e}),i.interceptors.response.use(e=>(e.data.err&&(0,n.oR)("Failed",{description:e.data.err||"Error in Request"}),e),e=>{var t,r,a,o,i;try{(0,n.oR)("Error In Request",{description:(null==e||null==(a=e.response)||null==(r=a.data)?void 0:r.err)||(null==e||null==(i=e.response)||null==(o=i.data)?void 0:o.message)||"Request Failed"})}catch(t){let{message:e}=t;console.error("error",e),(0,n.oR)("Error",{description:"failed to resolve response"})}return console.log("error",e),(null==(t=e.response)?void 0:t.status)==401&&((0,n.oR)("Auth Expired",{description:"Login in to continue"}),s.M.dispatch((0,l.ri)()),window.location.href="/"),Promise.reject(e)})},7997:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(5155),s=r(2115),l=r(4540),n=r(5784);let o={getLedgerReport:e=>n.S.get("/api/history/user_id/".concat(e))};var i=r(5041);let c=()=>{let e=(0,i.n)({mutationFn:async e=>o.getLedgerReport(e)});return{mutate:e.mutate,isPending:e.isPending,data:e.data,error:e.error}};var d=r(351),u=r(3464);let p=()=>{var e,t,r;let n=(0,l.d4)(e=>e.auth.user),{mutate:o,data:i={},error:p,isPending:m}=c(),[x,h]=(0,s.useState)(""),[g,y]=(0,s.useState)(""),[f,v]=(0,s.useState)(""),[b,j]=(0,s.useState)(""),[N,w]=(0,s.useState)(null),[S,O]=(0,s.useState)(1),[k,C]=(0,s.useState)(100);async function P(){if(x){var e,t;let r=await u.A.get("https://api.partner.kashishindiapvtltd.com/api/history/transaction_id/".concat(x,"?startDate=").concat(f,"&endDate=").concat(b));console.log("api filter ",null==r||null==(e=r.data)?void 0:e.data),w(null==r||null==(t=r.data)?void 0:t.data),O(1)}else w(null),O(1)}async function E(){if(g){var e,t;let r=await u.A.get("https://api.partner.kashishindiapvtltd.com/api/history/mobile/".concat(g,"?startDate=").concat(f,"&endDate=").concat(b));console.log("api filter ",null==r||null==(e=r.data)?void 0:e.data),w(null==r||null==(t=r.data)?void 0:t.data),O(1)}else w(null),O(1)}(0,s.useEffect)(()=>{console.log(null==n?void 0:n.id),(null==n?void 0:n.id)&&o(null==n?void 0:n.id)},[n,o]);let A=(null==N?void 0:N.rows)?N.rows.length:(null==i||null==(r=i.data)||null==(t=r.data)||null==(e=t.rows)?void 0:e.length)||0,D=Math.ceil(A/k),I=e=>O(e),_=(()=>{var e,t;if(null==N?void 0:N.rows)return N.rows;let r=(null==i||null==(t=i.data)||null==(e=t.data)?void 0:e.rows)||[],a=S*k;return r.slice(a-k,a)})();return(0,a.jsx)("div",{className:"p-4 bg-gray-50 min-h-screen",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-end",children:[(0,a.jsxs)("div",{className:"col-span-12 sm:col-span-6 md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.wIk,{className:"absolute left-3 top-2.5 text-gray-400"}),(0,a.jsx)("input",{type:"date",placeholder:"dd/mm/yyyy",className:"pl-10 pr-3 py-2 border border-gray-300 rounded-md w-full shadow-sm focus:outline-none focus:ring focus:ring-blue-500 text-sm",value:f,onChange:e=>v(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"col-span-12 sm:col-span-6 md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.wIk,{className:"absolute left-3 top-2.5 text-gray-400"}),(0,a.jsx)("input",{type:"date",placeholder:"dd/mm/yyyy",className:"pl-10 pr-3 py-2 border border-gray-300 rounded-md w-full shadow-sm focus:outline-none focus:ring focus:ring-blue-500 text-sm",value:b,onChange:e=>j(e.target.value)})]})]}),(0,a.jsx)("div",{className:"col-span-12 sm:col-span-3 md:col-span-3 md:col-start-10 flex justify-end",children:(0,a.jsxs)("button",{className:"bg-white text-gray-700 px-4 py-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 flex items-center",children:[(0,a.jsx)(d.a4x,{className:"mr-2"})," Export"]})})]})}),(0,a.jsxs)("div",{className:"flex mt-2 p-4",children:[(0,a.jsxs)("div",{className:"flex justify-end mb-4 gap-4 mr-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search With Transaction Id",className:"py-2 px-3 border border-gray-300 rounded-md text-sm w-64 placeholder-gray-600",value:x,onChange:e=>h(e.target.value)}),(0,a.jsx)("div",{className:"col-span-6 ml-4 sm:col-span-3 md:col-span-2",children:(0,a.jsxs)("button",{onClick:()=>{P()},className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-700 flex items-center justify-center",children:[(0,a.jsx)(d.UDU,{className:"mr-2"})," Find"]})})]}),(0,a.jsxs)("div",{className:"flex justify-end mb-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search With Recharge Number",className:"py-2 px-3 border border-gray-300 rounded-md text-sm w-64 placeholder-gray-600",value:g,onChange:e=>y(e.target.value)}),(0,a.jsx)("div",{className:"col-span-6 ml-4 sm:col-span-3 md:col-span-2",children:(0,a.jsxs)("button",{onClick:()=>{E()},className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-700 flex items-center justify-center",children:[(0,a.jsx)(d.UDU,{className:"mr-2"})," Find"]})})]})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-700",children:"Show"}),(0,a.jsxs)("select",{value:k,onChange:e=>{C(Number(e.target.value)),O(1)},className:"border border-gray-300 rounded-md px-2 py-1 text-sm focus:outline-none focus:ring focus:ring-blue-500",children:[(0,a.jsx)("option",{value:5,children:"5"}),(0,a.jsx)("option",{value:10,children:"10"}),(0,a.jsx)("option",{value:25,children:"25"}),(0,a.jsx)("option",{value:50,children:"50"}),(0,a.jsx)("option",{value:100,children:"100"})]}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:"entries"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Showing ",0===A?0:(S-1)*k+1," to"," ",Math.min(S*k,A)," of ",A," entries"]})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Sr. No"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Transaction ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date & Time"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Service"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Recharge Number"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Operation Circle"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:_.length>0?_.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:t+1}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:e.transaction_id}),(0,a.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-500",children:[new Date(e.createdAt).toLocaleDateString("en-GB")," ",new Date(e.createdAt).toLocaleTimeString("en-GB")]}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.service}),(0,a.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-500",children:["₹",e.txn_amount.toLocaleString()]}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.mobile}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.operatorCircle||"-"}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat("SUCCESS"===e.status?"bg-green-100 text-green-800":"FAILED"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e.status})})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"text-center text-sm py-6 text-gray-500",children:"No data available in table"})})})]})}),D>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Page ",S," of ",D]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("button",{onClick:()=>I(S-1),disabled:1===S,className:"px-3 py-1 border rounded-md flex items-center ".concat(1===S?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"),children:(0,a.jsx)(d.irw,{className:"w-4 h-4"})}),(()=>{let e=[];if(D<=5)for(let t=1;t<=D;t++)e.push(t);else if(S<=3){for(let t=1;t<=4;t++)e.push(t);e.push("..."),e.push(D)}else if(S>=D-2){e.push(1),e.push("...");for(let t=D-3;t<=D;t++)e.push(t)}else e.push(1),e.push("..."),e.push(S-1),e.push(S),e.push(S+1),e.push("..."),e.push(D);return e})().map((e,t)=>(0,a.jsx)("button",{onClick:()=>"number"==typeof e&&I(e),disabled:"..."===e,className:"px-3 py-1 border rounded-md ".concat(e===S?"bg-blue-600 text-white":"..."===e?"bg-white text-gray-400 cursor-default":"bg-white text-gray-700 hover:bg-gray-50"),children:e},t)),(0,a.jsx)("button",{onClick:()=>I(S+1),disabled:S===D,className:"px-3 py-1 border rounded-md flex items-center ".concat(S===D?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"),children:(0,a.jsx)(d.fOo,{className:"w-4 h-4"})})]})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[844,927,540,41,441,684,358],()=>t(1427)),_N_E=e.O()}]);