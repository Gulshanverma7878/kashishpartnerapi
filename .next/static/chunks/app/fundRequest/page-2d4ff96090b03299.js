(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[537],{413:(e,t,a)=>{"use strict";a.d(t,{M:()=>r});var n=a(1990),s=a(2525);let r=(0,n.U1)({reducer:{auth:s.Ay}})},1890:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var n=a(5155),s=a(2115),r=a(4540),l=a(5784);let i={getFundRequest:e=>l.S.get("/api/fund/user_id/".concat(e)),getBankRequest:()=>l.S.get("/api/bank"),postFundRequest:e=>l.S.post("/api/fund",e)};var d=a(5041);let o=()=>{let e=(0,d.n)({mutationFn:async e=>i.getFundRequest(e)});return{mutate:e.mutate,isPending:e.isPending,data:e.data,error:e.error}},u=()=>{let e=(0,d.n)({mutationFn:async e=>i.postFundRequest(e)});return{mutate:e.mutate,isPending:e.isPending,data:e.data,error:e.error}},c=e=>{let{label:t,children:a}=e;return(0,n.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-3 shadow-sm hover:shadow-md transition-all",children:[(0,n.jsx)("label",{className:"text-sm text-gray-500 font-semibold mb-1 block",children:t}),(0,n.jsx)("div",{children:a})]})},m=e=>{let{isOpen:t,onClose:a,onChange:s,onSubmit:r,onReset:l,isPending:i,formData:d,data:o,error:u,uniqueBankNames:m,setSelectedBank:x,accountNumbers:p}=e;return t?(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white backdrop-blur-md rounded-3xl shadow-2xl p-8 w-full max-w-4xl relative border border-gray-200",children:[(0,n.jsx)("button",{onClick:a,className:"absolute top-3 right-4 text-gray-600 text-2xl font-bold hover:text-red-500",children:"\xd7"}),(0,n.jsx)("h2",{className:"text-2xl font-bold text-blue-700 mb-6 text-center",children:"\uD83D\uDCDD Fund Request Form"}),(0,n.jsxs)("form",{onSubmit:r,className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,n.jsx)(c,{label:"Deposited Amount",children:(0,n.jsx)("input",{type:"number",name:"deposite_amount",value:d.deposite_amount,onChange:s,className:"w-full bg-white/60 border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-blue-400"})}),(0,n.jsx)(c,{label:"Payment Method",children:(0,n.jsxs)("select",{name:"payment_method",value:d.payment_method,onChange:s,className:"w-full bg-white/60 border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-blue-400",children:[(0,n.jsx)("option",{value:"",children:"Select Payment Method"}),(0,n.jsx)("option",{children:"NEFT"}),(0,n.jsx)("option",{children:"IMPS"}),(0,n.jsx)("option",{children:"UPI"})]})}),(0,n.jsx)(c,{label:"Date of Payment",children:(0,n.jsx)("input",{type:"date",name:"date",value:d.date,onChange:s,className:"w-full bg-white/60 border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-blue-400"})}),(0,n.jsx)(c,{label:"Bank Name",children:(0,n.jsxs)("select",{name:"bank_name",value:d.bank_name,onChange:e=>{s(e),x(e.target.value)},className:"w-full bg-white/60 border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-blue-400",children:[(0,n.jsx)("option",{value:"",children:"Select Bank Name"}),m.map((e,t)=>(0,n.jsx)("option",{value:e,children:e},t))]})}),(0,n.jsx)(c,{label:"Bank List",children:(0,n.jsxs)("select",{name:"account_number",value:d.account_number,onChange:s,className:"w-full bg-white/60 border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-blue-400",children:[(0,n.jsx)("option",{value:"",children:"Select Account"}),p.map((e,t)=>(0,n.jsx)("option",{value:e,children:e},t))]})}),(0,n.jsx)(c,{label:"Bank Reference / UTR",children:(0,n.jsx)("input",{type:"text",name:"bank_utr",value:d.bank_utr,onChange:s,className:"w-full bg-white/60 border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-blue-400"})}),(0,n.jsx)("div",{className:"md:col-span-2",children:(0,n.jsx)(c,{label:"Remarks",children:(0,n.jsx)("textarea",{name:"remark",rows:2,value:d.remark,onChange:s,className:"w-full bg-white/60 border rounded-lg px-3 py-2 resize-none outline-none focus:ring-2 focus:ring-blue-400"})})}),(0,n.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,n.jsx)("button",{type:"submit",disabled:i,className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-2 rounded-xl shadow hover:scale-105 transition",children:i?"Submitting...":"Submit"}),(0,n.jsx)("button",{type:"button",onClick:l,className:"bg-gray-300 text-gray-800 px-6 py-2 rounded-xl shadow hover:bg-gray-400 transition",children:"Reset"})]}),o&&(0,n.jsx)("p",{className:"text-green-600 col-span-3",children:"✅ Fund request submitted!"}),u&&(0,n.jsx)("p",{className:"text-red-600 col-span-3",children:"❌ Error submitting fund request."})]})]})}):null},x=e=>{let{data:t}=e;return(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Method"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bank Details"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Remark"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),(0,n.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["₹",e.deposite_amount]})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("div",{className:"text-sm text-gray-900",children:e.payment_method})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,n.jsx)("div",{children:e.bank_name}),(0,n.jsx)("div",{className:"text-xs text-gray-500",children:e.bank_utr})]})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("div",{className:"text-sm text-gray-900",children:e.date})}),(0,n.jsx)("td",{className:"px-6 py-4",children:(0,n.jsx)("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:e.remark})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("ACTIVE"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.status})})]},e.id))})]})})},p=()=>{let e=(0,d.n)({mutationFn:async()=>i.getBankRequest()});return{mutate:e.mutate,isPending:e.isPending,data:e.data,error:e.error}},h=()=>{var e,t,a,l,i;let d=(0,r.d4)(e=>e.auth.user),[c,h]=(0,s.useState)(!1),[g,b]=(0,s.useState)({user_id:(null==d?void 0:d.id)||"",deposite_amount:"",payment_method:"",bank_name:"",account_number:"",bank_utr:"",remark:"",date:""}),{mutate:y,isPending:f,data:j,error:v}=u(),{mutate:N,isPending:w,data:k,error:_}=o(),{mutate:S,isPending:R,data:C,error:q}=p(),[P,A]=(0,s.useState)(""),E=(null==k||null==(e=k.data)?void 0:e.data)||[];(0,s.useEffect)(()=>{(null==d?void 0:d.id)&&(N(d.id),S())},[null==d?void 0:d.id,N]);let F=Array.from(new Set((null!=(l=null==C||null==(t=C.data)?void 0:t.data)?l:[]).map(e=>e.bank_name))),I=(null!=(i=null==C||null==(a=C.data)?void 0:a.data)?i:[]).filter(e=>e.bank_name===P).map(e=>e.account_number);console.log(F),(0,s.useEffect)(()=>{(null==d?void 0:d.id)&&N(d.id)},[null==d?void 0:d.id,N]),(0,s.useEffect)(()=>{console.log(P),console.log(I),console.log(g)},[P,g]);let D=()=>{b({user_id:(null==d?void 0:d.id)||"",deposite_amount:"",payment_method:"",bank_name:"",bank_utr:"",remark:"",account_number:"",date:""})};return(0,n.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 space-y-4",children:[(0,n.jsx)("h2",{className:"font-bold  text-blue-800",children:"Fund Request History"}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)("button",{onClick:()=>h(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-5 py-2.5 sm:px-6 sm:py-3 rounded-xl shadow-lg hover:scale-105 transition duration-200",children:"+ New Request"})}),(0,n.jsx)(m,{isOpen:c,onClose:()=>h(!1),onChange:e=>{let{name:t,value:a}=e.target;b(e=>({...e,[t]:a}))},onSubmit:e=>{e.preventDefault(),y(g,{onSuccess:()=>{h(!1),D(),(null==d?void 0:d.id)&&N(d.id)}})},onReset:D,isPending:f,formData:g,data:j,error:v,uniqueBankNames:F,setSelectedBank:A,accountNumbers:I}),(0,n.jsx)("div",{className:"bg-white shadow-xl rounded-2xl p-6 sm:p-8 space-y-6",children:w?(0,n.jsx)("div",{className:"flex justify-center py-8",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"})}):_?(0,n.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:(0,n.jsx)("p",{className:"text-sm text-red-700",children:"Error loading fund requests. Please try again."})}):E.length>0?(0,n.jsx)(x,{data:E}):(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No fund requests"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new fund request."}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)("button",{onClick:()=>h(!0),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:"+ New Request"})})]})})]})}},2525:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>o,LA:()=>s,Qv:()=>l,ri:()=>r});let n=(0,a(1990).Z0)({name:"auth",initialState:{token:null,user:null,isAuthenticated:!1},reducers:{setCredentials:(e,t)=>{let{token:a,user:n}=t.payload;e.token=a,a&&!(a.length<=0)&&(e.user=n,e.isAuthenticated=!0,localStorage.setItem("token",a),localStorage.setItem("user",JSON.stringify(n)))},updateToken:(e,t)=>{let a=t.payload;a&&!(a.length<=0)&&(e.token=a,e.isAuthenticated=!0,localStorage.setItem("token",a))},updateUser:(e,t)=>{let a=t.payload;e.user=a,localStorage.setItem("user",JSON.stringify(a))},logout:e=>{e.token=null,e.user=null,e.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("user")},hydrate:e=>{let t=localStorage.getItem("token"),a=localStorage.getItem("user");e.token=t,e.user=a&&JSON.parse(a),e.isAuthenticated=!!(t&&a)}}}),{setCredentials:s,logout:r,hydrate:l,updateToken:i,updateUser:d}=n.actions,o=n.reducer},3658:(e,t,a)=>{Promise.resolve().then(a.bind(a,1890))},5784:(e,t,a)=>{"use strict";a.d(t,{S:()=>d});var n=a(3464),s=a(413),r=a(2525),l=a(6671);let i=a(9509).env.NEXT_PUBLIC_API_URL||"https://api.partner.kashishindiapvtltd.com/",d=n.A.create({baseURL:i,headers:{"Content-Type":"application/json"},timeout:6e5});d.interceptors.request.use(e=>{let t=s.M.getState().auth.token;return e.data instanceof FormData?e.headers["Content-Type"]="multipart/form-data":e.headers["Content-Type"]="application/json",t&&(e.headers.Authorization="Bearer ".concat(t)),e}),d.interceptors.response.use(e=>(e.data.err&&(0,l.oR)("Failed",{description:e.data.err||"Error in Request"}),e),e=>{var t,a,n,i,d;try{(0,l.oR)("Error In Request",{description:(null==e||null==(n=e.response)||null==(a=n.data)?void 0:a.err)||(null==e||null==(d=e.response)||null==(i=d.data)?void 0:i.message)||"Request Failed"})}catch(t){let{message:e}=t;console.error("error",e),(0,l.oR)("Error",{description:"failed to resolve response"})}return console.log("error",e),(null==(t=e.response)?void 0:t.status)==401&&((0,l.oR)("Auth Expired",{description:"Login in to continue"}),s.M.dispatch((0,r.ri)()),window.location.href="/"),Promise.reject(e)})}},e=>{var t=t=>e(e.s=t);e.O(0,[927,540,41,441,684,358],()=>t(3658)),_N_E=e.O()}]);